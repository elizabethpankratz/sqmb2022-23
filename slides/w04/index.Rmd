---
title: "Statistics and Quantitative Methods (S2)"
subtitle: "Week 4"
author: "Dr Stefano Coretta"
institute: "University of Edinburgh"
date: "2023/02/07"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - ../xaringan-themer.css
      - ../custom.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      beforeInit: "../macros.js"
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=7, fig.height=5, fig.retina=3,
  out.width = "60%", fig.align = "center",
  cache = FALSE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)
knitr::opts_knit$set(root.dir = here::here())

library(xaringanExtra)
use_xaringan_extra(c("panelset", "tachyons", "freezeframe"))

library(tidyverse)
theme_set(theme_light())
library(glue)
library(extraDistr)

options(ggplot2.discrete.fill = RColorBrewer::brewer.pal(8, "Dark2"))
options(ggplot2.discrete.colour = RColorBrewer::brewer.pal(8, "Dark2"))
options(show.signif.stars = FALSE)
```

```{r read-data}
alb_vot <- read_csv("data/alb_vot.csv") %>%
  mutate(
    vot = (voi_onset - release) * 1000
  )
alb_vot_vl <- alb_vot %>%
  filter(
    label %in% c("k", "p", "t"),
    vot < 20
  )
```

## Random variables

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
**We have a question about the world, so we sample from a population.**

- $y$ is a **sample** of values (`\(y_1, y_2, y_3, ..., y_n\)`).

- We say that the values in the sample $y$ were generated by a **random variable $Y$**.

]

--

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
In probability theory, **A random variable `\(Y\)` is a variable whose value is unknown and is generated by a random event.**

- $Y$ is uncertain.

- We can be describe $Y$ by talking about the **probabilities** of different values being taken on by $Y$.
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
**Probabilities are at the very core of statistics**, because the ultimate aim of statistics is to quantify WHAT?
]

---

layout: true

## Probabilities

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
**Probability**

- Of an event occurring or of a random variable taking on a specific value.

- Probabilities can only be **between 0 and 1**.

  - ⛔️ 0 means **impossible**.
  - 🤷 0.5 means **it can happen but it can also not happen**.
  - ✅ 1 means **certain**.
]

--

.center[
![:scale 50%](../../img/probabilities.png)
]

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
**Probability**

- Probability of an event occurring: 0 to 100% probability.

- **Probability of a random variable taking on a value**: a bit more complicated...
]

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
**We need probability distributions!**
]

---

layout: false
layout: true

## Probability distributions

---

<br>

![](../../img/grubabilities.png)

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
A **probability distribution** is a mathematical function that describes *how the probabilities are distributed over the values* that a random variable can take on.
]

--

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
Two types of probability distributions

- **Discrete probability distributions.**

- **Continuous probability distributions.**
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
**We talked about discrete and continuous variables in Week 2!**

Discrete variables follow discrete probability distributions and continuous variables follow continuous probability distributions.
]

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
We can visualise probability distributions:

- Using the **probability mass function** for discrete probability distributions.

- Using the **probability density function** for continuous probability distributions.
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
You don't need to understand the math behind this, but you are free to learn about it through the internet search engine of your choice!
]

---

**Probability Mass Function**

<br>

.center[
![:scale 50%](../../img/dice.png)
]

---

**Probability Density Function**

```{r vot-dens}
ggplot(data = tibble(x = -100:180), aes(x)) +
  stat_function(fun = dnorm, n = 101, args = list(30, 30)) +
  scale_x_continuous(n.breaks = 10) +
  labs(
    title = "Probability density of English VOT",
    x = "VOT", y = "Probability density (relative probability)"
  )
```

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
**Probability distributions can be expressed by a set of parameters.**

- We summarise a probability distribution with a **set of parameters**.

  - In mathematical notation: `\(\Theta = (\theta_1, ..., \theta_n)\)`
  
  - Different (sub-)types of probability distributions have a different number of parameters and different parameters.
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
The **Gaussian probability distribution** is a continuous probability distribution and it has two parameters:

- The mean $\mu$.
- The standard deviation $\sigma$.

]

Go to **[Seeing Theory](https://seeing-theory.brown.edu/probability-distributions/index.html#section2)**.

???

Seeing Theory was created by Daniel Kunin while an undergraduate at Brown University. The goal of this website is to make statistics more accessible through interactive visualizations (designed using Mike Bostock’s JavaScript library D3.js).

<https://seeing-theory.brown.edu/index.html#3rdPage>

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
In research, you try to **estimate** the probability distribution of the variable of interest (VOT, number of telic verbs, informativity score, acceptability ratings, ...).

- In other words you are trying to **estimate the parameters** of the probability distribution.
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
Now, let's talk a bit about ontology...
]

---

.bg-washed-yellow.b--orange.ba.bw2.br3.shadow-5.ph4.mt2[
**Frequentist view**

- The parameters are **fixed** (they are *unknown but certain*).

- They take on a specific value.
]

--

.bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt2[
**Bayesian view**

- The parameters are **random variables** (they are *unknown and uncertain*).

- We describe each parameter as a probability distribution.

- And each parameter's probability distribution is described by a set of parameters (called hyper-parameters).
]

---

layout: false
background-image: url(https://media.giphy.com/media/443pAv9m6Ti8KiCoAi/giphy.gif)

---

layout: true

## Albanian VOT

---

```{r alb-vot-1}
alb_vot_p <- alb_vot_vl %>%
  ggplot(aes(vot)) +
  geom_density(fill = "#9970ab", alpha = 0.5) +
  geom_rug() +
  scale_x_continuous(n.breaks = 5, limits = c(0, 20)) +
  labs(
    title = "VOT of Albanian voiceless stops",
    x = "VOT (ms)", y = "Relative probability"
  )
alb_vot_p
```

---

```{r alb-vot-2}
vot_mean <- mean(alb_vot_vl$vot)
vot_mean_text <- glue("mean: {round(vot_mean, 1)} ms")
vot_sd <- sd(alb_vot_vl$vot)
vot_sd_text <- glue("SD: {round(vot_sd, 1)} ms")
                        
alb_vot_p_2 <- alb_vot_p +
  geom_vline(xintercept = vot_mean, colour = "#1b7837", linewidth = 1) +
  annotate(
    "label", x = vot_mean + 1, y = 0.15,
    label = vot_mean_text,
    fill = "#1b7837", colour = "white"
  ) +
  annotate(
    "label", x = 19.25, y = 0.15,
    label = vot_sd_text,
    fill = "#8c510a", colour = "white"
  )
alb_vot_p_2
```


```{r alb-vot-3, eval=FALSE}
vot_median <- median(alb_vot_vl$vot)
vot_median_text <- glue("median: {round(vot_median)}")

alb_vot_p_2 +
  geom_vline(xintercept = vot_median, colour = "#8c510a", linewidth = 1) +
  annotate(
    "label", x = vot_median - 1, y = 0.015,
    label = vot_median_text,
    fill = "#8c510a", colour = "white"
  )
```

--

Based on the sample (N = 24): mean VOT = 12 ms, with SD = 3 ms.

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
**Sample of 24 VOT values of Albanian voiceless stops**.

- Sample mean = `r round(vot_mean, 1)` ms.
- Sample SD = `r round(vot_sd, 1)` ms.
]

--

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
Let's assume VOT values are **distributed according to a Gaussian distribution**.

- The VOT values we sampled are generated by a Gaussian distribution with mean $\mu$ and standard deviation $\sigma$.
]

--

<br>

.f3[
$$vot = Gaussian(\mu, \sigma)$$
]


---

```{r alb-vot-dist}
alb_dist <- ggplot(data = tibble(x = 0:25), aes(x)) +
  stat_function(fun = dnorm, n = 101, args = list(vot_mean, vot_sd), colour = "#9970ab", linewidth = 1.5) +
  scale_x_continuous(n.breaks = 5) +
  geom_vline(xintercept = vot_mean, colour = "#1b7837", linewidth = 1) +
  annotate(
    "label", x = vot_mean + 1, y = 0.15,
    label = vot_mean_text,
    fill = "#1b7837", colour = "white"
  ) +
  annotate(
    "label", x = 19.25, y = 0.15,
    label = vot_sd_text,
    fill = "#8c510a", colour = "white"
  ) +
  annotate(
    "label", x = 5, y = 0.1,
    label = "theoretical sample\ndistribution",
    fill = "#9970ab", colour = "white"
  ) +
  labs(
    title = "Theoretical sample distribution of Albanian voiceless stops VOT",
    subtitle = glue("Gaussian distribution: mean = {round(vot_mean, 1)} ms, SD = {round(vot_sd, 1)}"),
    x = "VOT (ms)", y = "Relative probability"
  )
alb_dist
```

---

```{r alb-vot-dist-2}
alb_dist +
  geom_density(data = alb_vot_vl, aes(vot), colour = "grey", fill = "grey", alpha = 0.2) +
  geom_rug(data = alb_vot_vl, aes(vot), alpha = 0.5) +
  annotate(
    "label", x = 20, y = 0.03,
    label = "empirical sample\ndistribution",
    fill = "grey", colour = "white"
  )
```

--

We want to make inferences about the population based on the sample.

---

.f3[
$$vot = Gaussian(\mu, \sigma)$$
]

**Parameters**: mean $\mu$ and SD $\sigma$.

--

.f3[
$$\mu = ...$$
$$\sigma = ...$$
]

---

.f3[
$$vot = Gaussian(\mu, \sigma)$$
]

**Parameters**: mean $\mu$ and SD $\sigma$.



.f3[
$$\mu = 12.6$$
$$\sigma = 2.8$$
]

--

<br>

**BUT**, this does not keep into consideration the **uncertainty and variability** of the sampling procedure.

---

.f3[
$$vot = Gaussian(\mu, \sigma)$$
]

**Parameters**: mean $\mu$ and SD $\sigma$.

--

.f3[
$$\mu = Gussian(\mu_1, \sigma_1)$$
]

**Hyperparameters**: mean $\mu_1$ and SD $\sigma_1$.

.f3[
$$\sigma = ...$$
]

--

Standard deviations are always positive! So we need a half Gaussian distribution (only the positive half!).

---

.f3[
$$vot = Gaussian(\mu, \sigma)$$
]

**Parameters**: mean $\mu$ and SD $\sigma$.

--

.f3[
$$\mu = Gussian(\mu_1, \sigma_1)$$
]

**Hyperparameters**: mean $\mu_1$ and SD $\sigma_1$.

.f3[
$$\sigma = HalfGaussian(\mu_2 = 0, \sigma_2)$$
]

**Hyperparameters**: mean $\mu_2$ = 0 and SD $\sigma_2$.

---

layout: false
layout: true

## Estimating probability distributions

---

.pull-left[
```{r norm, out.width = "100%"}
ggplot(data = tibble(x = -5:5), aes(x)) +
  stat_function(fun = dnorm, n = 101, args = list(0, 1)) +
  theme(
    axis.text.x = element_blank()
  )
```
]

.pull-right[
```{r hnorm, out.width = "100%"}
ggplot(data = tibble(x = 0:5), aes(x)) +
  stat_function(fun = dhnorm, n = 101, args = list(1)) +
  geom_vline(xintercept = 0) +
  theme(
    axis.text.x = element_blank()
  )
```
]

---

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt2[
- `\(Gaussian(\mu, \sigma)\)`

- We need to estimate:

  - `\(\mu_1\)` and $\sigma_1$ from the probability distribution of $\mu$.

  - $\sigma_2$ from the probability distribution of $\sigma$.
]
